<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" type="text/css" href="https://www.layuicdn.com/layui/css/layui.css"/>
    <link rel="stylesheet" type="text/css" href="/css/admin_login.css"/>
</head>
<body>
<div id="app">

    <div style="width: 30%; margin: auto; text-align: center;">

        <h1>基本信息</h1>
        <br>
        <br>

        <form class="layui-form">
            <div class="layui-form-item">
                <label class="layui-form-label">用户名</label>
                <div class="layui-input-block">
                    <input class="layui-input" type="text" name="name" placeholder="请输入用户名" required lay-verify="required" :value="user_info.name" />
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">QQ</label>
                <div class="layui-input-block">
                    <input class="layui-input" type="number" name="qq" placeholder="请输入QQ" required lay-verify="required" :value="user_info.qq" />
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">个人网站</label>
                <div class="layui-input-block">
                    <input class="layui-input" type="url" name="website" placeholder="请输入url" required lay-verify="required" :value="user_info.website" />
                </div>
            </div>
            <div class="layui-form-item layui-form-text">
                <label class="layui-form-label">个人简介</label>
                <div class="layui-input-block">
                    <textarea class="layui-textarea" name="desc" placeholder="请输入个人简介" :value="user_info.desc"></textarea>
                </div>
            </div>
            <button type="button" class="layui-btn layui-btn-normal" lay-submit lay-filter="change">修改</button>
        </form>
    </div>

</div>

<script src="https://www.layuicdn.com/layui/layui.js" charset="utf-8"></script>
<script type="text/javascript" src="https://unpkg.com/vue"></script>
<script>


    let app = new Vue({
        el:"#app",
        data:{
            user_info : {
                name: "",
                qq: "",
                website: "",
                desc: ""
            }
        },
        methods:{

        },
        mounted: function () {
            let this_ = this;

            layui.use(["element", "layer", "jquery", "form"], function () {
                let element = layui.element;
                let layer = layui.layer;
                let $ = layui.jquery;
                let form = layui.form;


                form.render();
                form.on('submit(change)', function (data) {
                    console.log(data.field);
                    $.ajax(
                        {
                            url:"/admin/api/user_info",
                            method: "POST",
                            data: data.field,
                            success : function (res) {
                                if(res.code !== 0)
                                {
                                    layer.alert(res.msg);
                                }
                                else
                                {
                                    layer.msg("修改成功", {icon: 1});
                                }
                            }
                        }
                    );
                });


                $.ajax(
                    {
                        url:"/admin/api/user_info",
                        method: "GET",
                        success : function (res) {
                            if(res.code !== 0)
                            {
                                layer.alert(res.msg);
                            }
                            else
                            {
                                this_.user_info = res.data;
                            }
                        }
                    }
                );

            });
        }
    });
</script>
</body>
</html>